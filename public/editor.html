<!DOCTYPE html>
<html data-bs-theme="dark" lang="en" data-bss-forced-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <title>jackthefine</title>
  <link rel="icon" type="image/jpeg" sizes="256x256" href="assets/img/d12f8639234ec709bb62060625bb2254.jpeg">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <script src="/nav.js"></script>
</head>
<body class="bg-dark text-light">

  <div class="container py-5">
    <h1 class="text-center mb-4">i love coding</h1>

    <div class="card bg-secondary p-3 mb-3">
      <div class="row g-2">
        <div class="col-md-5">
          <input id="keyInput" class="form-control" placeholder="Said thing">
        </div>
        <div class="col-md-5">
          <input id="valueInput" class="form-control" placeholder="Reply thing">
        </div>
        <div class="col-md-2 d-grid">
          <button id="addButton" class="btn btn-success">Add / Update</button>
        </div>
      </div>
    </div>

    <table class="table table-dark table-striped align-middle">
      <thead>
        <tr>
          <th>Said</th>
          <th>Reply</th>
          <th class="text-end">Actions</th>
        </tr>
      </thead>
      <tbody id="repliesTable"></tbody>
    </table>
  </div>

  <script>
    let wordReplies = {};

    async function loadReplies() {
      const response = await fetch('/wordReplies.json?_=' + Date.now());
      wordReplies = await response.json();
      refreshTable();
    }

    function refreshTable() {
      const table = $("#repliesTable");
      table.empty();
      for (const [key, value] of Object.entries(wordReplies)) {
        table.append(`
          <tr>
            <td>${key}</td>
            <td>${value}</td>
            <td class="text-end">
              <button class="btn btn-sm btn-primary me-2" onclick="editReply('${key}')">Edit</button>
              <button class="btn btn-sm btn-danger" onclick="deleteReply('${key}')">Delete</button>
            </td>
          </tr>
        `);
      }
    }

    function editReply(key) {
      $("#keyInput").val(key);
      $("#valueInput").val(wordReplies[key]);
    }

    function deleteReply(key) {
      delete wordReplies[key];
      refreshTable();
      saveReplies();
    }

    $("#addButton").on("click", () => {
      const key = $("#keyInput").val().trim();
      const value = $("#valueInput").val().trim();
      if (!key || !value) return alert("Please fill in both fields.");

      wordReplies[key] = value;
      $("#keyInput").val('');
      $("#valueInput").val('');
      refreshTable();
      saveReplies();
    });

    async function saveReplies() {
      await fetch('/save-wordReplies', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(wordReplies)
      });
    }

    loadReplies();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
